# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ò—Å—Ö–æ–¥—è –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**, –Ω–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ **–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã** –∏ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É**.

## üèóÔ∏è –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **–ú–æ–¥—É–ª–∏** (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã):
- **Validation Module** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- **Redis Health Module** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è Redis –∫–ª–∞—Å—Ç–µ—Ä–∞
- **Core Module** - –æ–±—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **–°–ª–æ–∏** (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è):
- **HTTP Layer** - CORS, Response, Middleware
- **Controllers Layer** - ValidationController, RedisHealthController
- **Services Layer** - ValidationService, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏
- **Domain Layer** - –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –º–æ–¥–µ–ª–∏
- **Infrastructure Layer** - Redis —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, Bootstrap, Router

### **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã:**
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π** (`POST /validate`)
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Redis** (`GET /status`)
3. **CORS/Preflight** (`OPTIONS` –∑–∞–ø—Ä–æ—Å—ã)

## üìä –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. **Feature —Ç–µ—Å—Ç—ã** (~60% —É—Å–∏–ª–∏–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ç–¥–∞—á–∞)

Feature-—Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç **–ø–æ–ª–Ω—ã–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã** end-to-end, –ø–æ–∫—Ä—ã–≤–∞—è –≤—Å–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–µ—è–≤–Ω–æ.

#### **1.1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π**
```php
// tests/Feature/ValidationFeatureTest.php
```


**üìã HTTP ‚Üí Controller ‚Üí Service ‚Üí Validators ‚Üí Response –∫–æ–Ω—Ç—Ä–∞–∫—Ç**

- ‚úÖ `POST /validate` —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ —Å–∫–æ–±–∫–∞–º–∏ `"(())"` ‚Üí 200 + `{"status": "valid"}`
- ‚úÖ `POST /validate` —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ —Å–∫–æ–±–∫–∞–º–∏ `"(()"` ‚Üí 400 + `{"status": "invalid"}`
- ‚úÖ `POST /validate` —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º `"(a)"` ‚Üí 400 + `{"status": "invalid_format"}`
- ‚úÖ `POST /validate` —Å –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π `""` ‚Üí 400 + `{"status": "empty"}`
- ‚úÖ `POST /validate` –±–µ–∑ –ø–æ–ª—è `string` ‚Üí 400 + `{"error": {"message": "..."}}`
- ‚úÖ `POST /validate` —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ç–∏–ø–æ–º –ø–æ–ª—è ‚Üí 400 + error message
- ‚úÖ `POST /validate` —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º JSON ‚Üí 400 + JSON parse error
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: `Content-Type: application/json`

#### **1.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Redis**
```php
// tests/Feature/RedisHealthFeatureTest.php
```


**üìã HTTP ‚Üí Controller ‚Üí HealthChecker ‚Üí Redis –∫–æ–Ω—Ç—Ä–∞–∫—Ç**

- ‚úÖ `GET /status` –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–æ–º Redis ‚Üí 200 + `{"redis_cluster": "connected"}`
- ‚úÖ `GET /status` –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º Redis ‚Üí 200 + `{"redis_cluster": "disconnected"}`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã JSON
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏–∑ RedisHealthChecker

#### **1.3. CORS/Preflight –æ–±—Ä–∞–±–æ—Ç–∫–∞**
```php
// tests/Feature/CorsFeatureTest.php
```


**üìã HTTP ‚Üí CORS Middleware ‚Üí Preflight Response –∫–æ–Ω—Ç—Ä–∞–∫—Ç**

- ‚úÖ `OPTIONS /validate` ‚Üí 200 + CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
- ‚úÖ `OPTIONS /status` ‚Üí 200 + CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
- ‚úÖ Preflight —Å `Access-Control-Request-Method` ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- ‚úÖ –û–±—ã—á–Ω—ã–µ POST/GET –∑–∞–ø—Ä–æ—Å—ã ‚Üí CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –æ—Ç–≤–µ—Ç–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: `Access-Control-Allow-Origin`, `Access-Control-Allow-Methods`

### 2. **Unit —Ç–µ—Å—Ç—ã** (~30% —É—Å–∏–ª–∏–π, —Å–ª–æ–∂–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)

Unit-—Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç **—Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É** —Å –≤—ã—Å–æ–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é.

#### **2.1. –î–æ–º–µ–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã (–∞–ª–≥–æ—Ä–∏—Ç–º—ã)**
```php
// tests/Unit/Domain/BracketValidatorTest.php
```


**üéØ –ê–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å–∞ —Å–∫–æ–±–æ–∫ (–æ–¥–Ω–æ–ø—Ä–æ—Ö–æ–¥–Ω—ã–π)**

- ‚úÖ –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ: `"()"`, `"(())"`, `"((()))"`, `"()()"`
- ‚úÖ –ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ: `"("`, `")"`, `"(()"`, `"())"`
- ‚úÖ –†–∞–Ω–Ω—è—è –æ—à–∏–±–∫–∞: `")("` ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π invalid
- ‚úÖ –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ edge case
- ‚úÖ –°–ª–æ–∂–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ: `"((())())"` ‚Üí valid
- üìä **Data Provider** –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

```php
// tests/Unit/Domain/FormatValidatorTest.php
```


**üéØ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**

- ‚úÖ –í–∞–ª–∏–¥–Ω—ã–µ —Å–∫–æ–±–∫–∏: `"()"`, `"(())"`, `"()()"`
- ‚úÖ –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: `"abc"`, `"(a)"`, `"123"`, `"!@#"`
- ‚úÖ –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã (>30 —Å–∏–º–≤–æ–ª–æ–≤) ‚Üí `invalid_format`
- ‚úÖ –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ—Å–ª–µ trim: `""`, `"   "` ‚Üí `empty`
- ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏: –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ Unicode —Å–∏–º–≤–æ–ª—ã: `"()üöÄ"` ‚Üí `invalid_format`
- üìä **Data Provider** –¥–ª—è edge cases

#### **2.2. –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (Value Objects)**
```php
// tests/Unit/Models/ValidationResultTest.php
```


**üéØ –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–±—Ä–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã**

- ‚úÖ –§–∞–±—Ä–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã: `valid()`, `invalid()`, `empty()`, `invalidFormat()`
- ‚úÖ –ü—Ä–µ–¥–∏–∫–∞—Ç—ã: `isValid()`, `isEmpty()`, `isInvalidFormat()`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ (immutability): —Å–≤–æ–π—Å—Ç–≤–∞ readonly
- ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏: –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ–∑–¥–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–π: –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã

### 3. **Integration —Ç–µ—Å—Ç—ã** (~10% —É—Å–∏–ª–∏–π, –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

Integration-—Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å **—Ä–µ–∞–ª—å–Ω—ã–º–∏ –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏**.

#### **3.1. Redis —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º**
```php
// tests/Integration/RedisHealthIntegrationTest.php
// @group integration (–∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Docker)
```


**üîó –†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis Cluster**

- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É Redis Cluster ‚Üí `"connected"`
- ‚úÖ –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π Redis (–ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç) ‚Üí `"disconnected"`
- ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (—á–∞—Å—Ç—å —É–∑–ª–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞) ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ä—É–º–∞
- ‚úÖ Timeout –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ ‚Üí graceful handling
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏—è RedisClusterException ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞
- üê≥ **–¢—Ä–µ–±—É–µ—Ç**: Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å Redis –¥–ª—è CI/CD

## üóÇÔ∏è –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ Feature/                                          # ~60% —É—Å–∏–ª–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ ValidationFeatureTest.php                     # POST /validate (8 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ RedisHealthFeatureTest.php                    # GET /status (4 —Ç–µ—Å—Ç–∞) 
‚îÇ   ‚îî‚îÄ‚îÄ CorsFeatureTest.php                           # OPTIONS /* (5 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ Unit/                                             # ~30% —É—Å–∏–ª–∏–π  
‚îÇ   ‚îú‚îÄ‚îÄ Domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BracketValidatorTest.php                  # –ê–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å–∞ (6 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FormatValidatorTest.php                   # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (7 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ Models/
‚îÇ       ‚îî‚îÄ‚îÄ ValidationResultTest.php                  # Value Object (5 —Ç–µ—Å—Ç–æ–≤)
‚îî‚îÄ‚îÄ Integration/                                      # ~10% —É—Å–∏–ª–∏–π
    ‚îî‚îÄ‚îÄ RedisHealthIntegrationTest.php                # –†–µ–∞–ª—å–Ω—ã–π Redis (6 —Ç–µ—Å—Ç–æ–≤)
```


**–ò—Ç–æ–≥–æ: ~40 —Ç–µ—Å—Ç–æ–≤** –≤–º–µ—Å—Ç–æ 100+ –≤ –∏–∑–±—ã—Ç–æ—á–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞

```xml
<!-- phpunit.xml -->
<phpunit>
    <groups>
        <exclude>
            <group>integration</group>
        </exclude>
    </groups>
    <testsuites>
        <testsuite name="Feature">
            <directory>tests/Feature</directory>
        </testsuite>
        <testsuite name="Unit">
            <directory>tests/Unit</directory>
        </testsuite>
    </testsuites>
</phpunit>
```


**–ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞:**
- `vendor/bin/phpunit` - Feature + Unit (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- `vendor/bin/phpunit --group integration` - —Ç–æ–ª—å–∫–æ Redis integration
- `vendor/bin/phpunit tests/Feature` - —Ç–æ–ª—å–∫–æ end-to-end —Å—Ü–µ–Ω–∞—Ä–∏–∏
- `vendor/bin/phpunit tests/Unit` - —Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### ‚úÖ **–ß—Ç–æ –ø–æ–∫—Ä—ã–≤–∞–µ–º:**
1. **–í—Å–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã** —á–µ—Ä–µ–∑ Feature-—Ç–µ—Å—Ç—ã
2. **–°–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** —á–µ—Ä–µ–∑ Unit-—Ç–µ—Å—Ç—ã
3. **–í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ Integration-—Ç–µ—Å—Ç—ã

### ‚ùå **–ß—Ç–æ –ù–ï —Ç–µ—Å—Ç–∏—Ä—É–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ:**
- –ü—Ä–æ—Å—Ç—ã–µ DTO –∫–ª–∞—Å—Å—ã (`JsonResponse`, `PreflightResponse`)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã –±–µ–∑ –ª–æ–≥–∏–∫–∏ (`ValidationController`, `App`)
- HTTP –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (`ResponseSender`) - –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Feature
- Router –∏ ExceptionHandler - –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Feature

### üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **~95% –ø–æ–∫—Ä—ã—Ç–∏—è** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π
- **~85% –ø–æ–∫—Ä—ã—Ç–∏—è** –∫–æ–¥–∞ (line coverage)
- **3-5 —Å–µ–∫—É–Ω–¥** –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
- **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** - –º–µ–Ω—å—à–µ —Ö—Ä—É–ø–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
- **–õ–µ–≥–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ** - –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

## üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–î–µ–Ω—å 1: Feature Tests (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1)**
- ValidationFeatureTest.php - –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
- RedisHealthFeatureTest.php - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- CorsFeatureTest.php - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

### **–î–µ–Ω—å 2: Unit Tests (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)**
- BracketValidatorTest.php - —è–¥—Ä–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- FormatValidatorTest.php - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–æ–≤
- ValidationResultTest.php - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **–î–µ–Ω—å 3: Integration Tests (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
- RedisHealthIntegrationTest.php - —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Docker

–≠—Ç–æ—Ç –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å** –≤ –∫–æ–¥–µ –ø—Ä–∏ **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç–∞—Ö** –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ç–µ—Å—Ç–æ–≤.


##  –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ 3 –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–∑–∞?

### **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ä–µ–∑–∞:**
1. ‚úÖ **–°–∫–≤–æ–∑–Ω–æ–π** - –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –≤—Å–µ —Å–ª–æ–∏ —Å–∏—Å—Ç–µ–º—ã
2. ‚úÖ **–¶–µ–Ω–Ω—ã–π** - –¥–∞—ë—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–ª—å–∑—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é/—Å–∏—Å—Ç–µ–º–µ
3. ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π** - –∏–º–µ–µ—Ç —á—ë—Ç–∫–∏–µ –≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã
4. ‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π** - –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ

##  –ê–Ω–∞–ª–∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ä–µ–∑–æ–≤

### **1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (`POST /validate`)**

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ä–µ–∑:**
```
HTTP –∑–∞–ø—Ä–æ—Å ‚Üí ValidationController ‚Üí ValidationService ‚Üí 
FormatValidator ‚Üí BracketValidator ‚Üí ValidationResult ‚Üí 
JsonResponse ‚Üí HTTP –æ—Ç–≤–µ—Ç
```


‚úÖ **–°–∫–≤–æ–∑–Ω–æ–π**: HTTP ‚Üí Controllers ‚Üí Services ‚Üí Domain ‚Üí Models ‚Üí HTTP  
‚úÖ **–¶–µ–Ω–Ω—ã–π**: –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π**: –ß—ë—Ç–∫–∏–µ –≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã, —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏  
‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π**: –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Redis (`GET /status`)**

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ä–µ–∑:**
```
HTTP –∑–∞–ø—Ä–æ—Å ‚Üí RedisHealthController ‚Üí RedisHealthChecker ‚Üí 
Redis Cluster ‚Üí —Å—Ç–∞—Ç—É—Å ‚Üí JsonResponse ‚Üí HTTP –æ—Ç–≤–µ—Ç
```


‚úÖ **–°–∫–≤–æ–∑–Ω–æ–π**: HTTP ‚Üí Controllers ‚Üí Domain ‚Üí Infrastructure ‚Üí HTTP  
‚úÖ **–¶–µ–Ω–Ω—ã–π**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã  
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π**: connected/disconnected —Å—Ç–∞—Ç—É—Å—ã  
‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π**: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### **3. CORS/Preflight (`OPTIONS` –∑–∞–ø—Ä–æ—Å—ã)**

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ä–µ–∑:**
```
OPTIONS –∑–∞–ø—Ä–æ—Å ‚Üí CorsMiddleware ‚Üí isPreflight() ‚Üí 
PreflightResponse ‚Üí CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ ‚Üí HTTP –æ—Ç–≤–µ—Ç
```


‚úÖ **–°–∫–≤–æ–∑–Ω–æ–π**: HTTP ‚Üí Middleware ‚Üí Response ‚Üí HTTP  
‚úÖ **–¶–µ–Ω–Ω—ã–π**: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞  
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π**: –ù–∞–ª–∏—á–∏–µ/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤  
‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π**: –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è

##  –≠—Ç–æ –í–°–ï –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏?

### **–î–ê, —ç—Ç–æ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ:**

1. **–ü–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ 2 –∑–∞–¥–∞—á–∏:
    - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ–∫ (–æ—Å–Ω–æ–≤–Ω–∞—è)
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Redis (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è)

2. **–ü–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º** - –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CORS –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

3. **–†–∞–∑–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - —ç—Ç–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º scope

##  –ß—Ç–æ –ù–ï —è–≤–ª—è–µ—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å—Ä–µ–∑–∞–º–∏

### **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–ª–æ–∏ (–ù–ï —Å—Ä–µ–∑—ã):**
- ‚ùå "HTTP –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞" - JsonResponse, ResponseSender
- ‚ùå "Core –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã" - App, Router, ExceptionHandler
- ‚ùå "Bootstrap –ø—Ä–æ—Ü–µ—Å—Å" - EnvironmentLoader
- ‚ùå "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫" - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

**–ü–æ—á–µ–º—É –ù–ï —Å—Ä–µ–∑—ã:** –ù–µ –¥–∞—é—Ç **—Ü–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** —Å–∞–º–∏ –ø–æ —Å–µ–±–µ, —ç—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ª–æ–∏.

##  –ú–æ–≥–ª–∏ –±—ã –±—ã—Ç—å –¥—Ä—É–≥–∏–µ —Å—Ä–µ–∑—ã?

### **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã:**

#### **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ JSON (`POST /validate`)**
```
–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON ‚Üí JsonException ‚Üí ExceptionHandler ‚Üí 
error response ‚Üí HTTP –æ—Ç–≤–µ—Ç
```


**–ù–æ —ç—Ç–æ –ù–ï –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ä–µ–∑**, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –ù–µ –∏–º–µ–µ—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏
- –Ø–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Å—Ä–µ–∑–∞ "–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ–∫"
- –≠—Ç–æ error-handling, –∞ –Ω–µ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

#### **5. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (500, 404)**
```
–õ—é–±–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Üí ExceptionHandler ‚Üí fallback response ‚Üí HTTP –æ—Ç–≤–µ—Ç
```


**–ù–æ —ç—Ç–æ –ù–ï –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ä–µ–∑**, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –≠—Ç–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ —Å—Ä–µ–∑—ã, –Ω–æ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å–∞–º

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–î–∞, —ç—Ç–∏ 3 —Å—Ä–µ–∑–∞ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –í–°–Æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. **Validation Slice** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å
2. **Redis Health Slice** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
3. **CORS Slice** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–ë–æ–ª—å—à–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ä–µ–∑–æ–≤ –≤ –¥–∞–Ω–Ω–æ–º –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- ‚úÖ –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã
- ‚úÖ –í—Å–µ endpoints –∏–º–µ—é—Ç —Å–≤–æ–∏ —Å—Ä–µ–∑—ã
- ‚úÖ Scope –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –∏ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π

–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è **–ø–æ–ª–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è** –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞!
